è¿™é‡Œè®¨è®ºçš„æ˜¯ï¼Œå¤šä¸ªå±å¹•æ—¶ï¼Œç”¨Nå¡çš„Surroundèåˆä¸ºä¸€ä¸ªå±å¹•ï¼Œå½“å¼€å§‹æ¸¸æˆåå‘ç”Ÿçš„é—®é¢˜
## åŸå› 
è¿™é‡Œçš„ä»£ç æˆªå›¾æ˜¯Unreal5.3.2ç‰ˆæœ¬
![](https://raw.githubusercontent.com/mengzhishanghun/mengzhishanghun/main/Blog/Assets/%E5%9B%BE%E7%89%87/Pasted%20image%2020240701121808.png)
å½“å…¨å±æ—¶ï¼Œä¼šè·å¾—ä¸€ä¸ªæœ€å¤§åˆ†è¾¨ç‡ï¼Œè¿™ä¸ªåˆ†è¾¨ç‡æ˜¯ä½ ä¸»å±å¹•çš„åˆ†è¾¨ç‡ï¼Œå³ä½¿æ˜¯é€šè¿‡Surroundèåˆæˆäº†ä¸€ä¸ªå¤§å±ï¼Œè¿™é‡Œä¹Ÿåªè·å–ä¹‹å‰å•å±çš„åˆ†è¾¨ç‡ï¼Œè¿™æ˜¯é€ æˆè¿™ä¸ªé—®é¢˜çš„æ ¹æœ¬åŸå› 
![](https://raw.githubusercontent.com/mengzhishanghun/mengzhishanghun/main/Blog/Assets/%E5%9B%BE%E7%89%87/Pasted%20image%2020240701121759.png)
ç„¶åå°±æ˜¯è¿™é‡Œï¼Œä¼šæ£€æµ‹å‘½ä»¤è¡Œé‡Œæœ‰æ²¡æœ‰ForceResï¼Œå¦‚æœæ²¡æœ‰å¹¶ä¸”ä½ è®¾ç½®çš„åˆ†è¾¨ç‡å¤§äºä½ çš„æœ€å¤§åˆ†è¾¨ç‡ï¼Œä¹Ÿå°±æ˜¯å•å±åˆ†è¾¨ç‡ï¼Œå°±å¼ºåˆ¶è®¾ç½®ä¸ºå•å±åˆ†è¾¨ç‡ï¼ŒUEå…¨å±æœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å½“ä½ çš„åˆ†è¾¨ç‡ä¸æ¯”å•å±åˆ†è¾¨ç‡å¤§çš„æ—¶å€™ï¼Œå¼ºåˆ¶ä½¿ç”¨ä¸€ä¸ªå±å¹•ï¼Œè¿™ä¸ªé—®é¢˜è¿˜æ²¡æœ‰æ‰¾åˆ°åœ¨å“ªé‡Œ
æ‰€æœ‰æˆ‘ä»¬èƒ½åšçš„æœ€ç®€å•çš„å¤„ç†åŠæ³•å°±æ˜¯è®©è¿™é‡Œè¯»åˆ°ForceResï¼Œæ¥é¿å…ä½¿ç”¨å•å±å¹•åˆ†è¾¨ç‡
## ä¿®æ”¹æ–¹æ¡ˆ
æ–¹æ¡ˆä¸€ï¼šç¨‹åºå¿«æ·æ–¹å¼åé¢åŠ -Fullscreenï¼Œè¿™ä¸ªæ˜¯é»˜è®¤å…¨å±ï¼Œä½†æ˜¯æœ‰ä¸ªé—®é¢˜ï¼ŒåŠ äº†è¿™ä¸ªå†è®¾ç½®ä¸ºæ— è¾¹æ¡†æ—¶ä¹Ÿåªæœ‰ä¸€ä¸ªæ˜¾ç¤ºå™¨èƒ½ç”¨ï¼Œæ‰€ä»¥å¦‚æœç¨‹åºåªè¿™æ˜¯å…¨å±å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ¡ˆ
æ–¹æ¡ˆäºŒï¼šç¨‹åºå¿«æ·æ–¹å¼åé¢åŠ -ForceResï¼Œè¿™ä¸ªæ˜¯å¼ºåˆ¶åˆ†è¾¨ç‡ï¼Œè¿™æ ·å°±å¯ä»¥å®Œç¾é¿å…è¿™ä¸ªé—®é¢˜
æ–¹æ¡ˆä¸‰ï¼šå¦‚æœè¯´ç¨‹åºä¸æ–¹ä¾¿ä½¿ç”¨æ·»åŠ å¿«æ·æ–¹å¼çš„è§£å†³åŠæ³•ï¼Œé‚£å¯ä»¥æ‰¾ä¸ªåˆé€‚çš„åœ°æ–¹è°ƒç”¨
```C++
FString CommandLine = FCommandLine::Get();
	CommandLine += " -ForceRes";
	FCommandLine::Set(*CommandLine);
	
	if(const UGameUserSettings* GameUserSettings = GEngine->GetGameUserSettings();
		GameUserSettings && GameUserSettings->GetFullscreenMode() == EWindowMode::Type::Fullscreen)
	{
		const FIntPoint IntPoint = GameUserSettings->GetScreenResolution();
		GameUserSettings->RequestResolutionChange(IntPoint.X, IntPoint.Y, EWindowMode::Type::Fullscreen, true);
	}
```
æˆ‘è¿™é‡Œæ˜¯åŠ åˆ°äº†EngineSubsystemä¸­ï¼Œå› ä¸ºè¿™ä¸ªåœ°æ–¹è¦å°½å¯èƒ½çš„æ—©
è¿™é‡Œæ˜¯æŠŠ-ForceResåŠ å…¥åˆ°å‘½ä»¤è¡Œä¸­ï¼Œåœ¨ä¸‹æ¬¡ä¿®æ”¹ä¸ºå…¨å±çš„æ—¶å€™å°±å¯ä»¥æ£€æµ‹åˆ°-ForceResè¿™ä¸ªå‘½ä»¤
ä¸‹é¢çš„åˆ™æ˜¯å¤„ç†ç¬¬ä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯æ¸¸æˆä¸€å¼€å§‹æ—¶çš„çŠ¶æ€ï¼Œå¦‚æœæ˜¯å…¨å±å¼€å§‹ï¼Œåˆ™æ‰‹åŠ¨è°ƒç”¨ä¸€ä¸‹åˆ†è¾¨ç‡æ”¹å˜å‡½æ•°ï¼Œæ¥ä¿è¯-ForceReså¯ä»¥è¢«åº”ç”¨
## å¦‚ä½•è·å–åˆé€‚çš„åˆ†è¾¨ç‡
```C++
	Resolutions.Empty();
	ResolutionsFullscreen.Empty();
	ResolutionsWindowed.Empty();
	ResolutionsWindowedFullscreen.Empty();

	FDisplayMetrics InitialDisplayMetrics;
	FSlateApplication::Get().GetInitialDisplayMetrics(InitialDisplayMetrics);

	FScreenResolutionArray ResArray;
	RHIGetAvailableResolutions(ResArray, true);

	auto Screen = [&](const TFunctionRef<bool(FVector2f const& Point)>& Fn, TArray<TSharedPtr<FScreenResolutionEntry>>& ResolutionArray)
	{
		for(const auto& [Width, Height, RefreshRate] : ResArray)
		{
			if(Fn(FVector2f(Width, Height)))
			{
				TSharedRef<FScreenResolutionEntry> Entry = MakeShared<FScreenResolutionEntry>();
				Entry->Width = Width;
				Entry->Height = Height;
				ResolutionArray.Emplace(Entry);
			}
		}
	};

	const FVector2f MinResolution(1280, 720);
	const FVector2f MaxResolution(InitialDisplayMetrics.PrimaryDisplayWidth, InitialDisplayMetrics.PrimaryDisplayHeight);
	const float AspectRatio = MaxResolution.X / MaxResolution.Y;
	
	int32 MaxResolutionX = InitialDisplayMetrics.PrimaryDisplayWidth;
	int32 MaxResolutionY = InitialDisplayMetrics.PrimaryDisplayHeight;
	if (InitialDisplayMetrics.MonitorInfo.Num() > 0)
	{
		for (const FMonitorInfo& MonitorInfo : InitialDisplayMetrics.MonitorInfo)
		{
			if (MonitorInfo.bIsPrimary)
			{
				MaxResolutionX = MonitorInfo.MaxResolution.X;
				MaxResolutionY = MonitorInfo.MaxResolution.Y;

				if (MaxResolutionX == 0 || MaxResolutionY == 0)
				{
					MaxResolutionX = MonitorInfo.NativeWidth;
					MaxResolutionY = MonitorInfo.NativeHeight;
				}
				break;
			}
		}
	}

	auto AddRes = [&](FVector2f Res)
	{
		Res.X = MaxResolution.X * Res.Y / MaxResolution.Y;
		
		FScreenResolutionRHI RHI;
		RHI.Width = Res.X;
		RHI.Height = Res.Y;

		for(int32 i = 0; i < ResArray.Num(); ++i)
		{
			if(ResArray[i].Width == RHI.Width && ResArray[i].Height == RHI.Height)
			{
				return;
			}
			else if(ResArray[i].Width == RHI.Width && ResArray[i].Height > RHI.Height)
			{
				ResArray.Insert(RHI, i);
				return;
			}
			else if(ResArray[i].Width > RHI.Width)
			{
				ResArray.Insert(RHI, i);
				return;	
			}
		}
		ResArray.Push(RHI);
	};

	// å¸¸ç”¨åˆ†è¾¨ç‡æ·»åŠ ï¼Œå¹¶ä¸”é€‚é…å¤šå±
	AddRes(FVector2f(1920, 1080));
	AddRes(FVector2f(2560, 1440));
	AddRes(FVector2f(3840, 2160));
	
	Screen([&](FVector2f const& Point)->bool
	{
		if(Point.X >= MinResolution.X && Point.Y >= MinResolution.Y && Point.X <= MaxResolution.X && Point.Y <= MaxResolution.Y
			&& AspectRatio == Point.X / Point.Y)
		{
			return true;
		}
		return false;	
	},ResolutionsWindowed);

	Screen([&](FVector2f const& Point)->bool
	{
		if(Point.X >= MinResolution.X && Point.Y >= MinResolution.Y && Point.X <= MaxResolution.X && Point.Y <= MaxResolution.Y
			&& AspectRatio == Point.X / Point.Y && Point.X > MaxResolutionX)
		{
			return true;
		}
		return false;	
	},ResolutionsFullscreen);

	Screen([&](FVector2f const& Point)->bool
	{
		if( Point.X == MaxResolution.X && Point.Y == MaxResolution.Y)
		{
			return true;
		}
		return false;	
	},ResolutionsWindowedFullscreen);	

```

è¿™ä¸ªæ˜¯åœ¨é¡¹ç›®ä¸­æ‹·è´å‡ºæ¥çš„ç‰‡æ®µï¼Œä»…ä¾›å‚è€ƒ

---

![å¾®ä¿¡æ”¯ä»˜](https://raw.githubusercontent.com/mengzhishanghun/mengzhishanghun/main/PayCodes/WeChatPay.jpg)

> ğŸ“¢ å¦‚æœæˆ‘çš„æ–‡ç« å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œæ¬¢è¿èµèµæ”¯æŒï¼Œè®©æˆ‘æœ‰æ›´å¤šåŠ¨åŠ›æŒç»­åˆ†äº« ğŸ™  
> ğŸ’¼ ä¸šåŠ¡åˆä½œ / Python è„šæœ¬ & UE æ’ä»¶å®šåˆ¶ï¼Œè¯·è”ç³» â†“  
> ğŸ“§ [mengzhishanghun@outlook.com](mengzhishanghun@outlook.com)